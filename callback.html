<script>
    
    const url = window.location.href.replace('#', '&'); 
   const finalURL = new URLSearchParams(url);
   
   var accessToken = finalURL.get('access_token');
   var idToken = finalURL.get('id_token');
   
   if (idToken) {
       const payload = parseJwt(idToken);
       const groups = payload["cognito:groups"] || [];
   
       console.log("User Groups:", groups);
       localStorage.clear();
    sessionStorage.clear();
   
       // **Store Tokens in Local Storage**
       localStorage.setItem("access_token", accessToken);
       localStorage.setItem("id_token", idToken);
   
       // Redirect to Admin or User Home
        if (groups.includes("admingrp")) {
           window.location.href = `https://master.dlxg3cfd1x67s.amplifyapp.com/admin/adminhome.html`;
        } else if (groups.includes("usergrp")) {
            window.location.href = `https://master.dlxg3cfd1x67s.amplifyapp.com/user/userhome.html`;
        }
      else {
           window.location.href = "https://master.dlxg3cfd1x67s.amplifyapp.com/";
        }
   } else {
       console.error("ID Token not found.");
       window.location.href = "https://master.dlxg3cfd1x67s.amplifyapp.com/";
   }
   
   // JWT Decode Function
   function parseJwt(token) {
       try {
           return JSON.parse(atob(token.split('.')[1]));
       } catch (e) {
           console.error("Invalid token format", e);
           return {};
       }
   }
   
   
   </script>